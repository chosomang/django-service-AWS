{% load static %}
<link rel="stylesheet" href="{% static '/css/rule_ani.css' %}">
<div class="col-xl">
    <div class='p-2'>
        <h2 class="mb-3 font-weight-bold text-center text-teiren">{{cloud}} 사용자 설정 정책 추가</h2>
        <div class="card-body shadow" style="border-radius:20px;">
            <div id="addbtns" class='row justify-content-center'>
                <button type='button' onclick='addSection("{{cloud}}", "static");return false' class='btn btn-md btn-outline-teiren mt-4 mr-3' >Static 정책</button>
                <button type='button' onclick='addSection("{{cloud}}", "dynamic");return false' class='btn btn-md btn-outline-teiren mt-4 mr-3' >Dynamic 정책</button>
            </div>
            <form id="new_rules">
                <input type="hidden" name="count" id="count" value='' />
                <input type="hidden" name="cloud" id="cloud" value='{{cloud}}' />
            </form>
        </div>
    </div>
</div>
<script>
    function addSection(cloud, ruleClass){
        $.ajax({
            url: `/threat/custom/add/${ruleClass}/`,
            headers:{
                'X-CSRFToken': '{{ csrf_token }}'
            },
            type: 'post',
            data:{
                cloud: cloud,
            }
        }).done(function(data){
            $('#new_rules').append(data)
            $('#rule_0').fadeIn('normal')
            $('#addbtns').slideUp()
        })
        if (ruleClass == 'dynamic'){
            $('#addNewRuleSetbtn').fadeOut('normal')
        }
    }

    function deleteSection(e){
        $('#rule_'+e).slideUp('normal')
        setTimeout(function(){
            $('#rule_'+e).remove()
        },500)
        if (e == 0){
            $('#addbtns').slideDown()
            $('#addNewRuleSetbtn').fadeIn('normal')
        }
    }
</script>